extends layout

block content
  .inner.py-2
    div(class='flex flex-row justify-end py-2')
      a(href=`/jobs/${job._id}/edit`) 
        button(class="bg-orange-500 hover:bg-orange-700 text-white font-bold p-2 rounded") Edit Job
    div(class="flex flex-col w-full bg-white rounded shadow-lg m-6")
      div(class="flex flex-col w-full md:flex-row")
        div(class="flex flex-row justify-around p-4 font-bold leading-none text-white uppercase bg-blue-400 rounded md:flex-col md:items-center md:justify-center md:w-1/4")
          div(class="md:text-5xl") #{h.moment(job.jobMailDate).add(9,"hours").format("MMMM")}
          div(class="md:text-6xl") #{h.moment(job.jobMailDate).add(9,"hours").format("DD")}
          div(class="md:text-4xl py-2") #{h.moment(job.jobMailDate).add(9,"hours").format("dddd")}
          
        div(class="p-4 font-normal text-gray-800 md:w-3/4")
          p(class="leading-normal font-bold text-3xl") #{job.jobName}
          p(class="leading-normal") Package Sizes - #{job.jobSize}
          p(class="leading-normal") #{job.jobTags} 
          div(class="flex flex-row items-center mt-4 text-black")
            - let quantity = job.jobQuantity;
            - (job.packages[0]) ? quantity = job.packages.reduce((t, { packageQuantity }) => t + packageQuantity, 0) :  quantity;
            div(class="w-1/2 ") #{quantity ? quantity.toLocaleString() : ''} Pieces in #{job.packages.length > 1 ? job.packages.length + " packages" : "1 package"}
            div(class="w-1/2 flex justify-end") #{job.jobMailingMethod}
    div(class="flex flex-col w-full md:flex-row")            
    h2.m-6.text-5xl Job Notes üìù 
    textarea.m-6.border-4.border-green-700.rounded-lg.shadow-lg(name="Notes", cols="20", rows="3" disabled) #{job.jobNotes}
    if job.packages != []
        div(class="flex flex-col w-full bg-white rounded shadow-lg m-6 p-4")
          div(class="flex flex-row justify-between")
            h1.text-5xl.py-2.m-2 Packages üì¶
            button(class="bg-blue-500 hover:bg-blue-400 text-white font-bold py-4 px-6 border-b-4 border-blue-700 hover:border-blue-500 rounded m-6 w-1/5")
              a(href=`/addPackage/${job._id}`) Add Package
          div(class="flex flex-col w-full md:flex-row")
            table(class="text-left w-full border-collapse")
              th(class="py-4 px-6 bg-green-500 font-bold uppercase text-xl text-grey-dark border-b border-black text-center") Package Name
              th(class="py-4 px-6 bg-green-500 font-bold uppercase text-xl text-grey-dark border-b border-black text-center") Mail Date
              th(class="py-4 px-6 bg-green-500 font-bold uppercase text-xl text-grey-dark border-b border-black text-center") Quantity
              th(class="py-4 px-6 bg-green-500 font-bold uppercase text-xl text-grey-dark border-b border-black text-center") Mailing Method
              th(class="py-4 px-6 bg-green-500 font-bold uppercase text-xl text-grey-dark border-b border-black text-center") Postage
              th(class="py-4 px-6 bg-green-500 font-bold uppercase text-xl text-grey-dark border-b border-black text-center") Size
              th(class="py-4 px-6 bg-green-500 font-bold uppercase text-xl text-grey-dark border-b border-black text-center") Scitex
              th(class="py-4 px-6 bg-green-500 font-bold uppercase text-xl text-grey-dark border-b border-black text-center") Notes
              th(class="py-4 px-6 bg-green-500 font-bold uppercase text-xl text-grey-dark border-b border-black text-center") Actions
              each p in job.packages  
                tr(class="hover:bg-blue-200") 
                  td(class="py-4 px-6 border-b border-grey-light text-center")= p.packageName ? p.packageName : ''
                  td(class="py-4 px-6 border-b border-grey-light text-center")= p.packageMaildate ? h.moment(p.packageMaildate).add(1,"days").format("MM-DD-YY") : ''
                  td(class="py-4 px-6 border-b border-grey-light text-center")= p.packageQuantity ? p.packageQuantity.toLocaleString('en') : ''
                  td(class="py-4 px-6 border-b border-grey-light text-center")= p.packageMailingMethod ? p.packageMailingMethod : ''
                  td(class="py-4 px-6 border-b border-grey-light text-center")= p.packagePostage ? p.packagePostage : ''
                  td(class="py-4 px-6 border-b border-grey-light text-center")= p.packageSize ? p.packageSize : ''
                  td(class="py-4 px-6 border-b border-grey-light text-center")= p.packageScitex ? '‚òë' : ''
                  td(class="py-4 px-6 border-b border-grey-light text-center")= p.packageNotes
                  td(class="py-4 px-6 border-b border-grey-light text-center") 
                    a(href=`/editPackage/${job.jobSlug}/${p._id}`)
                      button(class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-1 px-2 rounded m-1 w-full") Edit
                    a(href=`/deletePackage/${job.jobSlug}/${p._id}` onclick="return confirm('Are you sure you want to delete this item?');")
                      button(class="bg-red-500 hover:bg-red-700 text-white font-bold py-1 px-2 rounded m-1 w-full") Delete
    div(class="flex flex-row justify-between")
      a(href=`/commingle/${job.jobSlug}`) 
        button(class="bg-blue-500 hover:bg-blue-400 text-white font-bold py-4 px-6 border-b-4 border-blue-700 hover:border-blue-500 rounded m-6 w-full") Create Commingle Sheet
      a(href=`/shipping/${job.jobSlug}`) 
        button(class="bg-yellow-500 hover:bg-yellow-400 text-white font-bold py-4 px-6 border-b-4 border-yellow-700 hover:border-yellow-500 rounded m-6 w-full") Shipping
      a(href=`/deleteJob/${job._id}` onclick="return confirm('Are you sure you want to delete this item?');") 
        button(class="bg-red-500 hover:bg-red-400 text-white font-bold py-4 px-6 border-b-4 border-red-700 hover:border-red-500 rounded m-6 w-full") Delete Job